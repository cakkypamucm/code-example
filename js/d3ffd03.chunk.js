"use strict";(self.webpackChunkcode_example=self.webpackChunkcode_example||[]).push([[12],{5256:(e,t,a)=>{a.d(t,{Z:()=>d});var r=a(6767),i=a.n(r);var s=a(2822);const n="#cecece",o="#8eaaff",l="#c1c1c1",d={rowHeight:40,stageBackgroundColor:"white",fixedLayerBorderStroke:"black",betweenItemsLineStroke:n,timelinePrimaryColor:i()(n).darken(.4).hex(),fontDefaults:{fontSize:16,fontFamily:"Helvetica",wrap:"none",ellipsis:!0},mainLayer:{flightRectTimeoutMs:4e3,rect:{regularFill:o,activeFill:i()(o).darken(.25).hex(),padding:6,strokeWidth:2},noAirplanesMessage:{width:245,height:16,text:"Добавьте сюда воздушные суда",fill:"#6c757d"}},fixedAside:{width:110,textStartX:15},fixedHeader:{height:40},stageScrollbarLayer:{bar:{minimumGreaterDimension:64,width:s.Z.isMobileDevice()?32:12,padding:0,regularFill:l,activeFill:i()(l).darken(.1).hex(),opacity:.7},airplaneNumber:{y:22,fontSize:12},datetime:{text:"Дата/время",x:35,y:5,fontSize:12}},timelineGrid:{opacity:{specialHour:1,regularHour:.3}},timelineLegend:{startOfDay:{underlineY:26,textStartY:8,dateFormat:"DD MMM"},startOfQuarterDay:{underlineY:32,textStartY:18,fontSize:12,dateFormat:"HH:mm"}},flightSummary:{dateFormat:"DD MMM, HH:mm"},departure:"Вылет",arrival:"Посадка",airplane:{generateId:()=>+Math.random().toFixed(5).slice(2),number:"Номер борта",prefixName:"RA-"}}},1041:(e,t,a)=>{a.d(t,{Z:()=>n});var r=a(4475),i=a(5256);const s={store:(0,r.Z)(),widthCorrectionPx:i.Z.fixedAside.width,heightCorrectionPx:i.Z.fixedHeader.height,totalHeight(){return this.store.airplanes.length?this.heightCorrectionPx+this.store.airplanes.length*i.Z.rowHeight:i.Z.mainLayer.noAirplanesMessage.height},totalWidth(){return this.store.maxArrivalMs?this.widthCorrectionPx+this.dateToPx(new Date(this.store.maxArrivalMs))+this.getTotalWidthCorrection():i.Z.mainLayer.noAirplanesMessage.width},dateToPx(e){const t=new Date(this.store.minDepartureMs);return dayjs(e).diff(t,"minute")},getCurrentXByIndex(e){return this.widthCorrectionPx+this.dateToPx(dayjs(this.store.minDepartureMs).add(1,"hour").startOf("hour").toDate())+(e-1)*this.getHourInPx()},getCurrentDateByIndex(e){return dayjs(this.store.minDepartureMs).add(e,"hour").startOf("hour")},getHourInPx(){return this.dateToPx(dayjs(this.store.minDepartureMs).add(1,"hour").toDate())},getTotalWidthCorrection(){let e=this.getHourInPx()/2;return this.isSpecialHour(dayjs(this.store.maxArrivalMs).hour())&&(e+=this.getHourInPx()/2),e},isSpecialHour:e=>e%6==0,setTextDefaults:e=>_.defaults(e,i.Z.fontDefaults)},n=new class{constructor(){this.store=(0,r.Z)(),this.timeline=s}async fetch(e,t){const a=await this.store.fetch(e,t);return window.backdoor=this.store,a}getFlightSummary(e){const t=this.store.getAirplaneByFlightId(e),a=this.store.getFlight(e);if(null==t||null==a)return"Некорректный flightId";const r=e=>dayjs(e).format(i.Z.flightSummary.dateFormat);return`${i.Z.airplane.number}: ${t.name}        \n        \n${i.Z.departure}: ${r(a.departureDate)}\n        \n${i.Z.arrival}: ${r(a.arrivalDate)}`}}},4475:(e,t,a)=>{a.d(t,{Z:()=>l});a(7658);var r=a(830),i=a(5256);const s={fetch(e,t){return new Promise((a=>a(this.generate(e,t))))},generate(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:12,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;return _.range(e).map((()=>{const e=i.Z.airplane.generateId(),a={id:e,name:`${i.Z.airplane.prefixName+e}`},r=dayjs().subtract(1,"day").startOf("hour");return a.flights=_.range(t).map((e=>{let t=r.add(Math.round(4*(e+Math.random())*4)/4,"hour");const a=t.add(r.add(Math.round(4*(e+1)),"hour").diff(t,"hour"),"hour");return a.isSame(t)&&(t=a.subtract(45,"minute")),{id:i.Z.airplane.generateId(),departureDate:t.toDate(),arrivalDate:a.toDate()}})),a}))}},n=new Map,o=new Map,l=(0,r.Q_)("airplane",{state:()=>({airplanes:[],alreadyFetched:!1}),getters:{getFlight:e=>t=>{const a=n.get(t);if(null==a)return null;return e.airplanes[a.airplaneIndex].flights[a.flightIndex]},getAirplaneByFlightId:e=>t=>{const a=n.get(t);return null==a?null:e.airplanes[a.airplaneIndex]},minDepartureMs:e=>e.airplanes.reduce(((e,t)=>t.flights.reduce(((e,t)=>Math.min(e,t.departureDate.getTime())),e)),Number.MAX_SAFE_INTEGER),maxArrivalMs:e=>e.airplanes.reduce(((e,t)=>t.flights.reduce(((e,t)=>Math.max(e,t.arrivalDate.getTime())),e)),0)},actions:{async fetch(e,t){this.airplanes=await s.fetch(e,t),this.alreadyFetched=!0,this.airplanes.forEach(((e,t)=>{o.set(e.id,{airplaneIndex:t}),e.flights.forEach(((e,a)=>{n.set(e.id,{airplaneIndex:t,flightIndex:a})}))}))},push(e){if(!o.get(e.id)){this.airplanes.push(e);const t=this.airplanes.length-1;o.set(e.id,{airplaneIndex:t}),e.flights.forEach(((e,a)=>{n.set(e.id,{airplaneIndex:t,flightIndex:a})}))}},splice(){for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];this.airplanes.splice(t).forEach((e=>{o.delete(e.id),e.flights.forEach((e=>{n.delete(e.id)}))}))}}})},891:(e,t,a)=>{a.d(t,{Z:()=>h});var r=a(6252),i=a(9963);const s={class:"wrapper-page"},n={key:0,class:"main-header"},o={key:1,class:"main"},l={key:2,class:"main-footer"};const d={props:{show:{type:Boolean,default:!0}}};const h=(0,a(3744).Z)(d,[["render",function(e,t,a,d,h,u){return(0,r.wy)(((0,r.wg)(),(0,r.iD)("div",s,[e.$slots.header?((0,r.wg)(),(0,r.iD)("header",n,[(0,r.WI)(e.$slots,"header",{},void 0,!0)])):(0,r.kq)("",!0),e.$slots.default?((0,r.wg)(),(0,r.iD)("main",o,[(0,r.WI)(e.$slots,"default",{},void 0,!0)])):(0,r.kq)("",!0),e.$slots.footer?((0,r.wg)(),(0,r.iD)("footer",l,[(0,r.WI)(e.$slots,"footer",{},void 0,!0)])):(0,r.kq)("",!0)],512)),[[i.vShow,a.show]])}],["__scopeId","data-v-aeb90b02"]])},5662:(e,t,a)=>{a.r(t),a.d(t,{default:()=>y});var r=a(891),i=a(6252),s=a(3577);const n={class:"fps"},o={key:1,class:"no-airplane-message"};a(7658);var l=a(5762),d=a(2201),h=a(5256),u=a(1041),c=a(4475),p=a(9963);const g={data:()=>({moduleConfig:h.Z,store:(0,c.Z)(),fps:(0,l.sgm)(),chartOptions:{chart:{events:{load(){this.series.forEach((e=>{e.points.forEach((e=>{this.renderer.text(dayjs(e.options.start).utc().format("HH:mm"),e.plotX+this.plotLeft-20,e.plotY+this.plotTop-15).attr({rotation:90,zIndex:5}).css({fontSize:"10px",color:"black"}).add()}))}))}}},plotOptions:{series:{states:{inactive:{opacity:1}}}},series:[],yAxis:{categories:[]},tooltip:{outside:!0}}}),created(){this.init()},methods:{async init(){const{airplanesCount:e,flightsCount:t}=(0,d.yj)().query;await u.Z.fetch(e&&+e,t&&+t),this.setChartData()},setChartData(){const e=[],t=[];u.Z.store.airplanes.forEach(((a,r)=>{e.push({name:a.name,data:_.map(a.flights,(e=>({start:e.departureDate.getTime(),end:e.arrivalDate.getTime(),y:r,id:e.id}))),dataLabels:[{enabled:!0,format:'<i class="fas fa-arrow-up" style="font-size: 1.5em; margin-left: -20px"></i>',useHTML:!0,align:"left"},{enabled:!0,format:'<i class="fas fa-save" style="font-size: 1.5em"></i>',useHTML:!0,align:"center"},{enabled:!0,format:'<div style="width: 20px; height: 20px; overflow: hidden; border-radius: 50%;">\n                    <img src="https://github.com/bre1470.png" style="width: 30px; margin-left: -5px; margin-top: -2px">\n              </div>',useHTML:!0,align:"right"}]}),t.push(a.name)})),this.chartOptions.series=e,this.chartOptions.yAxis.categories=t}}},f=()=>{(0,p.useCssVars)((e=>({"6f0847a4":e.moduleConfig.mainLayer.noAirplanesMessage.width,"7f6c27e5":e.moduleConfig.mainLayer.noAirplanesMessage.fill,f09a2d34:e.moduleConfig.stageBackgroundColor})))},m=g.setup;g.setup=m?(e,t)=>(f(),m(e,t)):f;const x=g;const y=(0,a(3744).Z)(x,[["render",function(e,t,a,l,d,h){const u=(0,i.up)("highcharts"),c=r.Z;return(0,i.wg)(),(0,i.j4)(c,null,{default:(0,i.w5)((()=>[(0,i._)("div",n,"FPS: "+(0,s.toDisplayString)(d.fps),1),d.store.alreadyFetched?((0,i.wg)(),(0,i.iD)(i.HY,{key:0},[d.store.airplanes.length?((0,i.wg)(),(0,i.j4)(u,{key:0,class:"chart","constructor-type":"ganttChart",options:d.chartOptions},null,8,["options"])):((0,i.wg)(),(0,i.iD)("span",o,(0,s.toDisplayString)(d.moduleConfig.mainLayer.noAirplanesMessage.text),1))],64)):(0,i.kq)("",!0)])),_:1})}],["__scopeId","data-v-7d6599c2"]])}}]);
//# sourceMappingURL=d3ffd03.chunk.js.map