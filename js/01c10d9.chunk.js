"use strict";(self.webpackChunkcode_example=self.webpackChunkcode_example||[]).push([[184],{2550:(e,t,i)=>{i.d(t,{Z:()=>a});var r=i(3002),n=i(2822);i(4748);const a=new class{constructor(){this.toast=(0,r.NO)({position:"top-right",transition:"none",timeout:5e3,maxToasts:5,pauseOnFocusLoss:!1,pauseOnHover:!1,draggable:!0,draggablePercent:.25,hideProgressBar:!0})}showError(e){this.toast.error(n.Z.formatter.toUniqueSpaces(e))}showInfo(e,t){let{timeout:i}=t;this.toast.info(n.Z.formatter.toUniqueSpaces(e),{timeout:i})}clear(){this.toast.clear()}}},891:(e,t,i)=>{i.d(t,{Z:()=>g});var r=i(6252),n=i(9963);const a={class:"wrapper-page"},o={key:0,class:"main-header"},s={key:1,class:"main"},l={key:2,class:"main-footer"};const d={props:{show:{type:Boolean,default:!0}}};const g=(0,i(3744).Z)(d,[["render",function(e,t,i,d,g,h){return(0,r.wy)(((0,r.wg)(),(0,r.iD)("div",a,[e.$slots.header?((0,r.wg)(),(0,r.iD)("header",o,[(0,r.WI)(e.$slots,"header",{},void 0,!0)])):(0,r.kq)("",!0),e.$slots.default?((0,r.wg)(),(0,r.iD)("main",s,[(0,r.WI)(e.$slots,"default",{},void 0,!0)])):(0,r.kq)("",!0),e.$slots.footer?((0,r.wg)(),(0,r.iD)("footer",l,[(0,r.WI)(e.$slots,"footer",{},void 0,!0)])):(0,r.kq)("",!0)],512)),[[n.vShow,i.show]])}],["__scopeId","data-v-aeb90b02"]])},7704:(e,t,i)=>{i.r(t),i.d(t,{default:()=>Y});var r=i(891),n=i(6252),a=i(3577);const o={ref:"stageContainer",class:"stage-container"};i(4633);var s=i(6767),l=i.n(s),d=(i(7658),i(8692));const g={fetch(){return new Promise((e=>e(this.generate())))},generate(){const e=12+Math.round(5*Math.random()),t=10+Math.round(5*Math.random()),i=()=>+Math.random().toFixed(5).slice(2);return _.range(e).map((()=>{const e=i(),r={id:e,name:`RA-${e}`},n=dayjs().subtract(1,"day").startOf("hour");return r.flights=_.range(t).map((e=>{let t=n.add(Math.round(4*(e+Math.random())*4)/4,"hour");const r=t.add(n.add(Math.round(4*(e+1)),"hour").diff(t,"hour"),"hour");return r.isSame(t)&&(t=r.subtract(45,"minute")),{id:i(),departureDate:t.toDate(),arrivalDate:r.toDate()}})),r}))}},h=new Map,f=new Map,u=(0,d.Q_)("airplane",{state:()=>({airplanes:[]}),getters:{getFlight:e=>t=>{const i=h.get(t);if(null==i)return null;return e.airplanes[i.airplaneIndex].flights[i.flightIndex]},getAirplaneByFlightId:e=>t=>{const i=h.get(t);return null==i?null:e.airplanes[i.airplaneIndex]},minDepartureMs:e=>e.airplanes.reduce(((e,t)=>t.flights.reduce(((e,t)=>Math.min(e,t.departureDate.getTime())),e)),Number.MAX_SAFE_INTEGER),maxArrivalMs:e=>e.airplanes.reduce(((e,t)=>t.flights.reduce(((e,t)=>Math.max(e,t.arrivalDate.getTime())),e)),0)},actions:{async fetch(){this.airplanes=await g.fetch(),this.airplanes.forEach(((e,t)=>{f.set(e.id,{airplaneIndex:t}),e.flights.forEach(((e,i)=>{h.set(e.id,{airplaneIndex:t,flightIndex:i})}))}))},push(e){if(!f.get(e.id)){this.airplanes.push(e);const t=this.airplanes.length-1;f.set(e.id,{airplaneIndex:t}),e.flights.forEach(((e,i)=>{h.set(e.id,{airplaneIndex:t,flightIndex:i})}))}},splice(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];this.airplanes.splice(t).forEach((e=>{f.delete(e.id),e.flights.forEach((e=>{h.delete(e.id)}))}))}}}),c={store:u(),setWidthCorrectionPx(e){this.widthCorrectionPx=e},setHeightCorrectionPx(e){this.heightCorrectionPx=e},setRowHeight(e){this.rowHeight=e},totalHeight(){return this.store.airplanes.length?this.heightCorrectionPx+this.store.airplanes.length*this.rowHeight:this.noAirplanesMessageHeight},totalWidth(){return this.store.maxArrivalMs?this.widthCorrectionPx+this.dateToPx(new Date(this.store.maxArrivalMs))+this.getTotalWidthCorrection():this.noAirplanesMessageWidth},dateToPx(e){const t=new Date(this.store.minDepartureMs);return dayjs(e).diff(t,"minute")},getCurrentXByIndex(e){return this.widthCorrectionPx+this.dateToPx(dayjs(this.store.minDepartureMs).add(1,"hour").startOf("hour").toDate())+(e-1)*this.getHourInPx()},getCurrentDateByIndex(e){return dayjs(this.store.minDepartureMs).add(e,"hour").startOf("hour")},getHourInPx(){return this.dateToPx(dayjs(this.store.minDepartureMs).add(1,"hour").toDate())},getTotalWidthCorrection(){let e=this.getHourInPx()/2;return this.isSpecialHour(dayjs(this.store.maxArrivalMs).hour())&&(e+=this.getHourInPx()/2),e},isSpecialHour:e=>e%6==0,setTextDefaults:e=>_.defaults(e,{fontSize:16,fontFamily:"Helvetica",wrap:"none",ellipsis:!0}),noAirplanesMessageWidth:245,noAirplanesMessageHeight:16,noAirplanesMessageConfig:{text:"Добавьте сюда воздушные суда",fill:"#6c757d"},floor:Math.floor},m=new class{constructor(){this.store=u(),this.timeline=c}async fetch(){const e=await this.store.fetch();return window.backdoor=this.store,e}getFlightSummary(e){const t=this.store.getAirplaneByFlightId(e),i=this.store.getFlight(e);if(null==t||null==i)return"Некорректный flightId";const r=e=>dayjs(e).format("DD MMM, HH:mm");return`Номер: ${t.name}        \n        \nВылет: ${r(i.departureDate)}\n        \nПосадка: ${r(i.arrivalDate)}`}};var p=i(185),y=i.n(p);const x={props:{fixedAsideWidth:{type:Number,required:!0},fixedHeaderHeight:{type:Number,required:!0},rowHeight:{type:Number,required:!0},betweenItemsLineStroke:{type:String,required:!0},flightRectTimeoutMs:{type:Number,required:!0}},emits:{"flight-rect-pointerdown":e=>!!e,"flight-rect-pointerenter":e=>!!e,"flight-rect-pointerleave":e=>!!e},data(){const e="#8eaaff";return{module:m,airplanes:u().airplanes,regularFill:e,activeFill:l()(e).darken(.25).hex(),padding:6}},methods:{onPointerdownLayerHandler(e){e.target instanceof y().Rect&&this.onPointerdownRectHandler(e.target.attrs.dataId,e)},onPointerdownRectHandler(e,t){this.$emit("flight-rect-pointerdown",e);const i=t.target;i.fill(this.activeFill),i.stroke(this.activeFill),setTimeout((()=>{i.fill(this.regularFill),i.stroke(this.regularFill)}),this.flightRectTimeoutMs)},getStage(){return this.$refs.layer.getStage()}}};var H=i(3744);const w=(0,H.Z)(x,[["render",function(e,t,i,r,a,o){const s=(0,n.up)("k-line"),l=(0,n.up)("k-rect"),d=(0,n.up)("k-text"),g=(0,n.up)("k-layer");return(0,n.wg)(),(0,n.j4)(g,{ref:"layer",onPointerdown:o.onPointerdownLayerHandler},{default:(0,n.w5)((()=>[a.airplanes.length?((0,n.wg)(),(0,n.iD)(n.HY,{key:0},[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(a.airplanes,((e,t)=>((0,n.wg)(),(0,n.j4)(s,{key:e.id,config:{points:[0,i.fixedHeaderHeight+i.rowHeight*t,a.module.timeline.totalWidth(),i.fixedHeaderHeight+i.rowHeight*t],stroke:i.betweenItemsLineStroke}},null,8,["config"])))),128)),(0,n.WI)(e.$slots,"timeline-grid"),((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(a.airplanes,((t,r)=>((0,n.wg)(),(0,n.iD)(n.HY,{key:t.id},[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(t.flights,(t=>((0,n.wg)(),(0,n.j4)(l,{key:t.id,config:{dataId:t.id,x:i.fixedAsideWidth+a.module.timeline.dateToPx(t.departureDate),y:i.fixedHeaderHeight+i.rowHeight*r+a.padding,width:a.module.timeline.dateToPx(t.arrivalDate)-a.module.timeline.dateToPx(t.departureDate),height:i.rowHeight-2*a.padding,fill:a.regularFill,stroke:a.regularFill,strokeWidth:2,perfectDrawEnabled:!1},onPointerenter:i=>e.$emit("flight-rect-pointerenter",t.id),onPointerleave:i=>e.$emit("flight-rect-pointerleave",t.id)},null,8,["config","onPointerenter","onPointerleave"])))),128))],64)))),128))],64)):((0,n.wg)(),(0,n.j4)(d,{key:1,config:a.module.timeline.setTextDefaults(a.module.timeline.noAirplanesMessageConfig)},null,8,["config"]))])),_:3},8,["onPointerdown"])}]]),k=w;const B={props:{fixedAsideWidth:{type:Number,required:!0},fixedHeaderHeight:{type:Number,required:!0},rowHeight:{type:Number,required:!0},stageBackgroundColor:{type:String,required:!0},fixedLayerBorderStroke:{type:String,required:!0},betweenItemsLineStroke:{type:String,required:!0}},data:()=>({module:m,airplanes:u().airplanes,startX:15}),methods:{getStage(){return this.$refs.layer.getStage()}}},C=(0,H.Z)(B,[["render",function(e,t,i,r,a,o){const s=(0,n.up)("k-rect"),l=(0,n.up)("k-text"),d=(0,n.up)("k-line"),g=(0,n.up)("k-layer");return(0,n.wg)(),(0,n.j4)(g,{ref:"layer"},{default:(0,n.w5)((()=>[a.airplanes.length?((0,n.wg)(),(0,n.iD)(n.HY,{key:0},[(0,n.Wm)(s,{config:{x:0,y:i.fixedHeaderHeight,width:i.fixedAsideWidth,height:a.module.timeline.totalHeight(),fill:i.stageBackgroundColor}},null,8,["config"]),((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(a.airplanes,((e,t)=>((0,n.wg)(),(0,n.iD)(n.HY,{key:e.name},[(0,n.Wm)(l,{config:a.module.timeline.setTextDefaults({x:a.startX,y:i.fixedHeaderHeight+10+i.rowHeight*t+4,text:e.name,width:i.fixedAsideWidth-2*a.startX,fill:i.fixedLayerBorderStroke})},null,8,["config"]),(0,n.Wm)(d,{config:{points:[0,i.fixedHeaderHeight+i.rowHeight*t,i.fixedAsideWidth-1,i.fixedHeaderHeight+i.rowHeight*t],stroke:i.betweenItemsLineStroke}},null,8,["config"])],64)))),128)),(0,n.Wm)(d,{config:{points:[i.fixedAsideWidth,0,i.fixedAsideWidth,a.module.timeline.totalHeight()],stroke:i.fixedLayerBorderStroke}},null,8,["config"])],64)):(0,n.kq)("",!0)])),_:1},512)}]]),S=C;const D={props:{fixedAsideWidth:{type:Number,required:!0},fixedHeaderHeight:{type:Number,required:!0},stageBackgroundColor:{type:String,required:!0},fixedLayerBorderStroke:{type:String,required:!0}},data:()=>({module:m,airplanes:u().airplanes}),methods:{getStage(){return this.$refs.layer.getStage()}}},W=(0,H.Z)(D,[["render",function(e,t,i,r,a,o){const s=(0,n.up)("k-rect"),l=(0,n.up)("k-line"),d=(0,n.up)("k-layer");return(0,n.wg)(),(0,n.j4)(d,{ref:"layer"},{default:(0,n.w5)((()=>[a.airplanes.length?((0,n.wg)(),(0,n.iD)(n.HY,{key:0},[(0,n.Wm)(s,{config:{x:0,y:0,width:a.module.timeline.totalWidth(),height:i.fixedHeaderHeight-1,fill:i.stageBackgroundColor}},null,8,["config"]),(0,n.WI)(e.$slots,"timeline-legend"),(0,n.Wm)(l,{config:{points:[i.fixedAsideWidth,i.fixedHeaderHeight-1,a.module.timeline.totalWidth(),i.fixedHeaderHeight-1],stroke:i.fixedLayerBorderStroke}},null,8,["config"])],64)):(0,n.kq)("",!0)])),_:3},512)}]]);var P=i(2822);const b={props:{stage:{type:Object,required:!0},stageConfig:{type:Object,required:!0},mainlayer:{type:Object,required:!0},verticalScrollableLayers:{type:Array,required:!0},horizontalScrollableLayers:{type:Array,required:!0},fixedAsideWidth:{type:Number,required:!0},fixedHeaderHeight:{type:Number,required:!0},stageBackgroundColor:{type:String,required:!0},fixedLayerBorderStroke:{type:String,required:!0}},data(){const e="#c1c1c1";return{module:m,airplanes:u().airplanes,scrollBarOptions:{minimumGreaterDimension:64,width:P.Z.isMobileDevice()?32:12,padding:0,regularFill:e,activeFill:l()(e).darken(.1).hex(),opacity:.7},vBarConfig:null,hBarConfig:null}},created(){const e=this;this.vBarConfig={width:this.scrollBarOptions.width,fill:this.scrollBarOptions.regularFill,y:this.scrollBarOptions.padding,opacity:this.scrollBarOptions.opacity,draggable:!0,dragBoundFunc(t){return t.x=e.stageConfig.width-e.scrollBarOptions.padding-e.scrollBarOptions.width,t.y=Math.max(Math.min(t.y,e.stageConfig.height-this.height()-e.scrollBarOptions.padding),e.scrollBarOptions.padding),t}},this.hBarConfig={height:this.scrollBarOptions.width,fill:this.scrollBarOptions.regularFill,x:this.scrollBarOptions.padding,opacity:this.scrollBarOptions.opacity,draggable:!0,dragBoundFunc(t){return t.x=Math.max(Math.min(t.x,e.stageConfig.width-this.width()-e.scrollBarOptions.padding),e.scrollBarOptions.padding),t.y=e.stageConfig.height-e.scrollBarOptions.padding-e.scrollBarOptions.width,t}},window.addEventListener("resize",_.throttle(this.onWindowResizeHandler,100)),this.onWindowResizeHandler()},mounted(){this.stage.on("wheel",this.onWheelHandler)},methods:{onWindowResizeHandler(){Object.assign(this.vBarConfig,{x:this.stageConfig.width-this.scrollBarOptions.padding-this.scrollBarOptions.width,height:Math.round(this.stageConfig.height*this.stageConfig.height/m.timeline.totalHeight())}),Object.assign(this.hBarConfig,{y:this.stageConfig.height-this.scrollBarOptions.padding-this.scrollBarOptions.width,width:this.ensureComfortableScrollbarSize(Math.ceil(this.stageConfig.width*this.stageConfig.width/m.timeline.totalWidth()))})},onPointerenterHandler(e){e.fill=this.scrollBarOptions.activeFill},onPointerleaveHandler(e){e.fill=this.scrollBarOptions.regularFill},onDragmoveVBarHandler(){const e=this.$refs.vBar.getStage(),t=this.stageConfig.height-2*this.scrollBarOptions.padding-e.height(),i=(e.y()-this.scrollBarOptions.padding)/t;this.verticalScrollableLayers.forEach((e=>e.y(-(m.timeline.totalHeight()-this.stageConfig.height)*i)))},onDragmoveHBarHandler(){const e=this.$refs.hBar.getStage(),t=this.stageConfig.width-2*this.scrollBarOptions.padding-e.width(),i=(e.x()-this.scrollBarOptions.padding)/t;this.horizontalScrollableLayers.forEach((e=>e.x(-(m.timeline.totalWidth()-this.stageConfig.width)*i)))},onWheelHandler(e){let{evt:t}=e;t.preventDefault();const i=t.deltaX,r=t.deltaY,n=this.$refs.vBar?.getStage(),a=this.$refs.hBar?.getStage(),o=-(m.timeline.totalWidth()-this.stageConfig.width),s=Math.max(o,Math.min(this.mainlayer.x()-i,0)),l=-(m.timeline.totalHeight()-this.stageConfig.height),d=Math.max(l,Math.min(this.mainlayer.y()-r,0));n&&this.verticalScrollableLayers.forEach((e=>e.y(d))),a&&this.horizontalScrollableLayers.forEach((e=>e.x(s)));const g=this.stageConfig.height-2*this.scrollBarOptions.padding-(n?.height()||0),h=this.mainlayer.y()/(-m.timeline.totalHeight()+this.stageConfig.height)*g+this.scrollBarOptions.padding;n?.y(h);const f=this.stageConfig.width-2*this.scrollBarOptions.padding-(a?.width()||0),u=this.mainlayer.x()/(-m.timeline.totalWidth()+this.stageConfig.width)*f+this.scrollBarOptions.padding;a?.x(u)},ensureComfortableScrollbarSize(e){return Math.max(this.scrollBarOptions.minimumGreaterDimension,e)}}},v=(0,H.Z)(b,[["render",function(e,t,i,r,a,o){const s=(0,n.up)("k-rect"),l=(0,n.up)("k-line"),d=(0,n.up)("k-text"),g=(0,n.up)("k-layer");return(0,n.wg)(),(0,n.j4)(g,null,{default:(0,n.w5)((()=>[a.airplanes.length?((0,n.wg)(),(0,n.iD)(n.HY,{key:0},[i.stageConfig.height<a.module.timeline.totalHeight()?((0,n.wg)(),(0,n.j4)(s,{key:0,ref:"vBar",config:a.vBarConfig,onPointerenter:t[0]||(t[0]=e=>o.onPointerenterHandler(a.vBarConfig)),onPointerleave:t[1]||(t[1]=e=>o.onPointerleaveHandler(a.vBarConfig)),onDragmove:o.onDragmoveVBarHandler},null,8,["config","onDragmove"])):(0,n.kq)("",!0),i.stageConfig.width<a.module.timeline.totalWidth()?((0,n.wg)(),(0,n.j4)(s,{key:1,ref:"hBar",config:a.hBarConfig,onPointerenter:t[2]||(t[2]=e=>o.onPointerenterHandler(a.hBarConfig)),onPointerleave:t[3]||(t[3]=e=>o.onPointerleaveHandler(a.hBarConfig)),onDragmove:o.onDragmoveHBarHandler},null,8,["config","onDragmove"])):(0,n.kq)("",!0),(0,n.Wm)(s,{config:{x:0,y:0,width:i.fixedAsideWidth+1,height:i.fixedHeaderHeight+1,fill:i.stageBackgroundColor,strokeWidth:0}},null,8,["config"]),(0,n.Wm)(l,{config:{points:[i.fixedAsideWidth,i.fixedHeaderHeight+1,i.fixedAsideWidth,i.fixedHeaderHeight-2],stroke:i.fixedLayerBorderStroke}},null,8,["config"]),(0,n.Wm)(d,{config:a.module.timeline.setTextDefaults({x:20,y:20,text:"Номер",fill:i.fixedLayerBorderStroke,fontSize:12})},null,8,["config"]),(0,n.Wm)(d,{config:a.module.timeline.setTextDefaults({x:35,y:5,text:"Дата/время",fill:i.fixedLayerBorderStroke,fontSize:12})},null,8,["config"])],64)):(0,n.kq)("",!0)])),_:1})}]]);const I={props:{timelinePrimaryColor:{type:String,required:!0}},data:()=>({timeline:m.timeline})},M=(0,H.Z)(I,[["render",function(e,t,i,r,a,o){const s=(0,n.up)("k-line");return a.timeline.totalWidth()/a.timeline.getHourInPx()>=1?((0,n.wg)(!0),(0,n.iD)(n.HY,{key:0},(0,n.Ko)(a.timeline.floor(a.timeline.totalWidth()/a.timeline.getHourInPx()),(e=>((0,n.wg)(),(0,n.j4)(s,{key:e,config:{points:[a.timeline.getCurrentXByIndex(e),0,a.timeline.getCurrentXByIndex(e),a.timeline.totalHeight()],stroke:i.timelinePrimaryColor,opacity:a.timeline.isSpecialHour(a.timeline.getCurrentDateByIndex(e).hour())?1:.3}},null,8,["config"])))),128)):(0,n.kq)("",!0)}]]);const O={props:{fixedHeaderHeight:{type:Number,required:!0},timelinePrimaryColor:{type:String,required:!0}},data:()=>({timeline:m.timeline,underlineYStartOfDay:26,underlineYStartOfQuarterDay:32})},A=(0,H.Z)(O,[["render",function(e,t,i,r,a,o){const s=(0,n.up)("k-line"),l=(0,n.up)("k-text");return a.timeline.totalWidth()/a.timeline.getHourInPx()>=1?((0,n.wg)(!0),(0,n.iD)(n.HY,{key:0},(0,n.Ko)(a.timeline.floor(a.timeline.totalWidth()/a.timeline.getHourInPx()),(e=>((0,n.wg)(),(0,n.iD)(n.HY,{key:e},[0===a.timeline.getCurrentDateByIndex(e).hour()?((0,n.wg)(),(0,n.iD)(n.HY,{key:0},[(0,n.Wm)(s,{config:{points:[a.timeline.getCurrentXByIndex(e),a.underlineYStartOfDay,a.timeline.getCurrentXByIndex(e),i.fixedHeaderHeight],stroke:i.timelinePrimaryColor}},null,8,["config"]),(0,n.Wm)(s,{config:{points:[a.timeline.getCurrentXByIndex(e),a.underlineYStartOfDay,a.timeline.getCurrentXByIndex(e)+a.timeline.getHourInPx(),a.underlineYStartOfDay],stroke:i.timelinePrimaryColor}},null,8,["config"]),(0,n.Wm)(l,{config:a.timeline.setTextDefaults({x:a.timeline.getCurrentXByIndex(e),y:8,text:a.timeline.getCurrentDateByIndex(e).format("DD MMM"),fill:i.timelinePrimaryColor})},null,8,["config"])],64)):a.timeline.isSpecialHour(a.timeline.getCurrentDateByIndex(e).hour())?((0,n.wg)(),(0,n.iD)(n.HY,{key:1},[(0,n.Wm)(s,{config:{points:[a.timeline.getCurrentXByIndex(e),a.underlineYStartOfQuarterDay,a.timeline.getCurrentXByIndex(e),i.fixedHeaderHeight],stroke:i.timelinePrimaryColor}},null,8,["config"]),(0,n.Wm)(s,{config:{points:[a.timeline.getCurrentXByIndex(e),a.underlineYStartOfQuarterDay,a.timeline.getCurrentXByIndex(e)+a.timeline.getHourInPx()/2,a.underlineYStartOfQuarterDay],stroke:i.timelinePrimaryColor}},null,8,["config"]),(0,n.Wm)(l,{config:a.timeline.setTextDefaults({x:a.timeline.getCurrentXByIndex(e),y:18,fontSize:12,text:a.timeline.getCurrentDateByIndex(e).format("HH:mm"),fill:i.timelinePrimaryColor})},null,8,["config"])],64)):(0,n.kq)("",!0)],64)))),128)):(0,n.kq)("",!0)}]]);var L=i(2550),q=i(9963);const T={components:{MainLayer:k,FixedAsideLayer:S,FixedHeaderLayer:W,StageScrollbarLayer:v,TimelineGrid:M,TimelineLegend:A},data(){const e="#cecece";return{stageBackgroundColor:"white",betweenItemsLineStroke:e,timelinePrimaryColor:l()(e).darken(.4).hex(),rowHeight:40,fixedLayerBorderStroke:"black",fixedHeaderHeight:40,fixedAsideWidth:110,flightRectTimeoutMs:4e3,module:m,store:u(),toast:L.Z,stage:null,configs:{stage:{},mainLayer:{},fixedAside:{},fixedHeader:{},stageScrollbar:{props:{readyToMount:!1}},timelineGrid:{},timelineLegend:{}},noAirplanesMessageWidth:m.timeline.noAirplanesMessageWidth}},watch:{"store.airplanes":{handler(){this.actualizeStageDimensions()},deep:!0}},beforeUnmount(){L.Z.clear()},created(){this.init()},methods:{async init(){await m.fetch(),m.timeline.setWidthCorrectionPx(this.fixedAsideWidth),m.timeline.setHeightCorrectionPx(this.fixedHeaderHeight),m.timeline.setRowHeight(this.rowHeight),await this.initConfigs()},async initConfigs(){this.configs.mainLayer.props=Object.fromEntries(this.entriesThisProps("fixedAsideWidth fixedHeaderHeight rowHeight betweenItemsLineStroke flightRectTimeoutMs")),this.configs.fixedAside.props=Object.fromEntries(this.entriesThisProps("fixedAsideWidth fixedHeaderHeight rowHeight stageBackgroundColor fixedLayerBorderStroke betweenItemsLineStroke")),this.configs.fixedHeader.props=Object.fromEntries(this.entriesThisProps("fixedHeaderHeight fixedAsideWidth stageBackgroundColor fixedLayerBorderStroke")),this.configs.stageScrollbar.props=Object.fromEntries(this.entriesThisProps("fixedAsideWidth fixedHeaderHeight stageBackgroundColor fixedLayerBorderStroke")),this.configs.timelineGrid.props=Object.fromEntries(this.entriesThisProps("timelinePrimaryColor")),this.configs.timelineLegend.props=Object.fromEntries(this.entriesThisProps("fixedHeaderHeight timelinePrimaryColor")),window.addEventListener("resize",_.throttle(this.actualizeStageDimensions,100)),this.actualizeStageDimensions(),await this.$nextTick(),this.stage=this.$refs.stage.getStage(),this.stage.container().style.backgroundColor=this.stageBackgroundColor;const e=this.$refs.main.getStage(),t=this.$refs.fixedAside.getStage(),i=this.$refs.fixedHeader.getStage();Object.assign(this.configs.stageScrollbar.props,{stage:this.stage,stageConfig:this.configs.stage,mainlayer:e,verticalScrollableLayers:[e,t],horizontalScrollableLayers:[e,i]}),this.configs.stageScrollbar.props.readyToMount=!0},entriesThisProps(e){return e.split(" ").map((e=>[e,this[e]]))},actualizeStageDimensions(){this.configs.stage.width=Math.min(m.timeline.totalWidth(),this.$refs.stageContainer.offsetWidth),this.configs.stage.height=Math.min(m.timeline.totalHeight(),this.$refs.stageContainer.offsetHeight),this.stage?this.stage.getContainer().style.border=""+(this.store.airplanes.length?"1px solid black":"none"):setImmediate(this.actualizeStageDimensions)}}},F=()=>{(0,q.useCssVars)((e=>({"324b2476":e.noAirplanesMessageWidth})))},j=T.setup;T.setup=j?(e,t)=>(F(),j(e,t)):F;const $=T,Y=(0,H.Z)($,[["render",function(e,t,i,s,l,d){const g=(0,n.up)("timeline-grid"),h=(0,n.up)("main-layer"),f=(0,n.up)("fixed-aside-layer"),u=(0,n.up)("timeline-legend"),c=(0,n.up)("fixed-header-layer"),m=(0,n.up)("stage-scrollbar-layer"),p=(0,n.up)("k-stage"),y=r.Z;return(0,n.wg)(),(0,n.j4)(y,null,{default:(0,n.w5)((()=>[(0,n._)("div",o,[l.configs.stage.height?((0,n.wg)(),(0,n.j4)(p,{key:0,ref:"stage",config:l.configs.stage},{default:(0,n.w5)((()=>[(0,n.Wm)(h,(0,n.dG)({ref:"main"},l.configs.mainLayer.props,{onFlightRectPointerdown:t[0]||(t[0]=e=>l.toast.showInfo(l.module.getFlightSummary(e),{timeout:l.flightRectTimeoutMs})),onFlightRectPointerenter:t[1]||(t[1]=e=>l.stage.container().style.cursor="pointer"),onFlightRectPointerleave:t[2]||(t[2]=e=>l.stage.container().style.cursor="default")}),{"timeline-grid":(0,n.w5)((()=>[(0,n.Wm)(g,(0,a.normalizeProps)((0,n.F4)(l.configs.timelineGrid.props)),null,16)])),_:1},16),(0,n.Wm)(f,(0,n.dG)({ref:"fixedAside"},l.configs.fixedAside.props),null,16),(0,n.Wm)(c,(0,n.dG)({ref:"fixedHeader"},l.configs.fixedHeader.props),{"timeline-legend":(0,n.w5)((()=>[(0,n.Wm)(u,(0,a.normalizeProps)((0,n.F4)(l.configs.timelineLegend.props)),null,16)])),_:1},16),l.configs.stageScrollbar.props.readyToMount?((0,n.wg)(),(0,n.j4)(m,(0,a.normalizeProps)((0,n.dG)({key:0},l.configs.stageScrollbar.props)),null,16)):(0,n.kq)("",!0)])),_:1},8,["config"])):(0,n.kq)("",!0)],512)])),_:1})}],["__scopeId","data-v-bc8fcec6"]])}}]);
//# sourceMappingURL=01c10d9.chunk.js.map