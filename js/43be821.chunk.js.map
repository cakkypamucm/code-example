{"version":3,"file":"js/43be821.chunk.js","mappings":"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","sources":["webpack://code-example/./src/modules/airplane/config.js","webpack://code-example/./src/assets/scss/variables.module.scss","webpack://code-example/./src/modules/airplane/timeline.js","webpack://code-example/./src/modules/airplane/index.js","webpack://code-example/./src/modules/airplane/service.js","webpack://code-example/./src/modules/airplane/store.js","webpack://code-example/./src/layouts/page-default.vue?0e5d","webpack://code-example/./src/layouts/page-default.vue?f1f1","webpack://code-example/./src/layouts/page-default.vue?5595","webpack://code-example/./src/pages/flights/gantt.vue?f7cd","webpack://code-example/./src/pages/flights/gantt.vue?4f7c","webpack://code-example/./src/pages/flights/gantt.vue?587d"],"sourcesContent":["import Color from \"color\";\r\nimport scssVars from \"@/assets/scss/variables.module\";\r\nimport helper from \"@/helpers/frontend\";\r\n\r\nconst betweenItemsLineStroke = \"#cecece\";\r\nconst mainLayerRectRegularFill = \"#8eaaff\";\r\nconst scrollbarRegularFill = \"#c1c1c1\";\r\n\r\nexport default {\r\n    rowHeight: 40,\r\n\r\n    stageBackgroundColor: \"white\",\r\n    fixedLayerBorderStroke: \"black\",\r\n\r\n    betweenItemsLineStroke,\r\n    timelinePrimaryColor: Color(betweenItemsLineStroke).darken(0.4).hex(),\r\n\r\n    fontDefaults: {\r\n        fontSize: 16,\r\n        fontFamily: \"Helvetica\",\r\n        wrap: \"none\",\r\n        ellipsis: true\r\n    },\r\n\r\n    mainLayer: {\r\n        flightRectTimeoutMs: 4000,\r\n        rect: {\r\n            regularFill: mainLayerRectRegularFill,\r\n            activeFill: Color(mainLayerRectRegularFill).darken(0.25).hex(),\r\n            padding: 6,\r\n            strokeWidth: 2\r\n        },\r\n        noAirplanesMessage: {\r\n            width: 245,\r\n            height: 16,\r\n            text: \"Добавьте сюда воздушные суда\",\r\n            fill: scssVars[\"help-text-color\"]\r\n        }\r\n    },\r\n\r\n    fixedAside: {\r\n        width: 110,\r\n        textStartX: 15\r\n    },\r\n\r\n    fixedHeader: {\r\n        height: 40\r\n    },\r\n\r\n    stageScrollbarLayer: {\r\n        bar: {\r\n            minimumGreaterDimension: 64,\r\n            width: helper.isMobileDevice() ? 32 : 12,\r\n            padding: 0,\r\n            regularFill: scrollbarRegularFill,\r\n            activeFill: Color(scrollbarRegularFill).darken(0.1).hex(),\r\n            opacity: 0.7\r\n        },\r\n\r\n        airplaneNumber: {\r\n            y: 22,\r\n            fontSize: 12\r\n        },\r\n\r\n        datetime: {\r\n            text: \"Дата/время\",\r\n            x: 35,\r\n            y: 5,\r\n            fontSize: 12\r\n        }\r\n    },\r\n\r\n    timelineGrid: {\r\n        opacity: {\r\n            specialHour: 1,\r\n            regularHour: 0.3\r\n        }\r\n    },\r\n\r\n    timelineLegend: {\r\n        startOfDay: {\r\n            underlineY: 26,\r\n            textStartY: 8,\r\n            dateFormat: \"DD MMM\"\r\n        },\r\n\r\n        startOfQuarterDay: {\r\n            underlineY: 32,\r\n            textStartY: 18,\r\n            fontSize: 12,\r\n            dateFormat: \"HH:mm\"\r\n        }\r\n    },\r\n\r\n    flightSummary: {\r\n        dateFormat: \"DD MMM, HH:mm\"\r\n    },\r\n\r\n    departure: \"Вылет\",\r\n    arrival: \"Посадка\",\r\n\r\n    airplane: {\r\n        generateId: () => +Math.random().toFixed(5).slice(2),\r\n        number: \"Номер борта\",\r\n        prefixName: \"RA-\"\r\n    }\r\n};\r\n","// extracted by mini-css-extract-plugin\nexport default {\"help-text-color\":\"#6c757d\"};","import useStore from \"./store\";\r\nimport moduleConfig from \"./config\";\r\n\r\nexport default {\r\n    store: useStore(),\r\n\r\n    widthCorrectionPx: moduleConfig.fixedAside.width,\r\n\r\n    heightCorrectionPx: moduleConfig.fixedHeader.height,\r\n\r\n    totalHeight() {\r\n        if (this.store.airplanes.length) {\r\n            return this.heightCorrectionPx + this.store.airplanes.length * moduleConfig.rowHeight;\r\n        }\r\n        return moduleConfig.mainLayer.noAirplanesMessage.height;\r\n    },\r\n\r\n    totalWidth() {\r\n        if (this.store.maxArrivalMs) {\r\n            return (\r\n                this.widthCorrectionPx +\r\n                this.dateToPx(new Date(this.store.maxArrivalMs)) +\r\n                this.getTotalWidthCorrection()\r\n            );\r\n        }\r\n        return moduleConfig.mainLayer.noAirplanesMessage.width;\r\n    },\r\n\r\n    // судя по тестовым данным, типичный полёт длится несколько часов => удобно принять, что 1час=60px, 1мин=1px\r\n    dateToPx(date) {\r\n        const minDate = new Date(this.store.minDepartureMs);\r\n        return dayjs(date).diff(minDate, \"minute\");\r\n    },\r\n\r\n    getCurrentXByIndex(index) {\r\n        return (\r\n            this.widthCorrectionPx +\r\n            this.dateToPx(dayjs(this.store.minDepartureMs).add(1, \"hour\").startOf(\"hour\").toDate()) +\r\n            (index - 1) * this.getHourInPx()\r\n        );\r\n    },\r\n\r\n    getCurrentDateByIndex(index) {\r\n        return dayjs(this.store.minDepartureMs).add(index, \"hour\").startOf(\"hour\");\r\n    },\r\n\r\n    getHourInPx() {\r\n        return this.dateToPx(dayjs(this.store.minDepartureMs).add(1, \"hour\").toDate());\r\n    },\r\n\r\n    getTotalWidthCorrection() {\r\n        let correction = this.getHourInPx() / 2;\r\n        if (this.isSpecialHour(dayjs(this.store.maxArrivalMs).hour())) {\r\n            correction += this.getHourInPx() / 2;\r\n        }\r\n        return correction;\r\n    },\r\n\r\n    isSpecialHour(hour) {\r\n        return hour % 6 === 0;\r\n    },\r\n\r\n    setTextDefaults(config) {\r\n        return _.defaults(config, moduleConfig.fontDefaults);\r\n    }\r\n};\r\n","import useStore from \"./store\";\r\nimport timeline from \"./timeline\";\r\nimport config from \"./config\";\r\n\r\nexport default new (class {\r\n    constructor() {\r\n        this.store = useStore();\r\n        this.timeline = timeline;\r\n    }\r\n\r\n    async fetch(airplanesCount, flightsCount) {\r\n        const data = await this.store.fetch(airplanesCount, flightsCount);\r\n        window.backdoor = this.store;\r\n        return data;\r\n    }\r\n\r\n    getFlightSummary(flightId) {\r\n        const airplane = this.store.getAirplaneByFlightId(flightId);\r\n        const flight = this.store.getFlight(flightId);\r\n        if (airplane == null || flight == null) {\r\n            return \"Некорректный flightId\";\r\n        }\r\n        const formatDate = (date) => dayjs(date).format(config.flightSummary.dateFormat);\r\n        return `${config.airplane.number}: ${airplane.name}        \r\n        \\n${config.departure}: ${formatDate(flight.departureDate)}\r\n        \\n${config.arrival}: ${formatDate(flight.arrivalDate)}`;\r\n    }\r\n})();\r\n","import config from \"./config\";\r\n\r\nexport default {\r\n    fetch(airplanesCount, flightsCount) {\r\n        return new Promise((resolve) => resolve(this.generate(airplanesCount, flightsCount)));\r\n    },\r\n\r\n    generate(airplanesCount, flightsCount) {\r\n        airplanesCount = Number.parseInt(airplanesCount);\r\n        if (Number.isNaN(airplanesCount) || airplanesCount < 0) {\r\n            airplanesCount = 12;\r\n        }\r\n        flightsCount = Number.parseInt(flightsCount);\r\n        if (Number.isNaN(flightsCount) || flightsCount < 0) {\r\n            flightsCount = 10;\r\n        }\r\n\r\n        const averageDurationHours = 4;\r\n        return _.range(airplanesCount).map(() => {\r\n            const id = config.airplane.generateId();\r\n            const airplane = {\r\n                id,\r\n                name: `${config.airplane.prefixName + id}`\r\n            };\r\n            const initialDate = dayjs().subtract(1, \"day\").startOf(\"hour\");\r\n            airplane.flights = _.range(flightsCount).map((flightsIndex) => {\r\n                let departureDate = initialDate.add(\r\n                    Math.round((flightsIndex + Math.random()) * averageDurationHours * 4) / 4,\r\n                    \"hour\"\r\n                );\r\n                const arrivalDate = departureDate.add(\r\n                    initialDate\r\n                        .add(Math.round((flightsIndex + 1) * averageDurationHours), \"hour\")\r\n                        .diff(departureDate, \"hour\"),\r\n                    \"hour\"\r\n                );\r\n                if (arrivalDate.isSame(departureDate)) {\r\n                    departureDate = arrivalDate.subtract(45, \"minute\");\r\n                }\r\n                return {\r\n                    id: config.airplane.generateId(),\r\n                    departureDate: departureDate.toDate(),\r\n                    arrivalDate: arrivalDate.toDate()\r\n                };\r\n            });\r\n            return airplane;\r\n        });\r\n    }\r\n};\r\n","import { defineStore } from \"pinia\";\r\n\r\nimport service from \"./service\";\r\n\r\nconst flightsById = new Map();\r\nconst airplanesById = new Map();\r\n\r\nexport default defineStore(\"airplane\", {\r\n    state: () => ({\r\n        airplanes: [],\r\n        alreadyFetched: false\r\n    }),\r\n    getters: {\r\n        getFlight: (state) => (id) => {\r\n            const info = flightsById.get(id);\r\n            if (info == null) {\r\n                return null;\r\n            }\r\n            const airplane = state.airplanes[info.airplaneIndex];\r\n            return airplane.flights[info.flightIndex];\r\n        },\r\n        getAirplaneByFlightId: (state) => (id) => {\r\n            const info = flightsById.get(id);\r\n            if (info == null) {\r\n                return null;\r\n            }\r\n            return state.airplanes[info.airplaneIndex];\r\n        },\r\n        minDepartureMs(state) {\r\n            return state.airplanes.reduce(\r\n                (minInAirplanes, airplane) =>\r\n                    airplane.flights.reduce(\r\n                        (min, flight) => Math.min(min, flight.departureDate.getTime()),\r\n                        minInAirplanes\r\n                    ),\r\n                Number.MAX_SAFE_INTEGER\r\n            );\r\n        },\r\n        maxArrivalMs(state) {\r\n            return state.airplanes.reduce(\r\n                (maxInAirplanes, airplane) =>\r\n                    airplane.flights.reduce(\r\n                        (max, flight) => Math.max(max, flight.arrivalDate.getTime()),\r\n                        maxInAirplanes\r\n                    ),\r\n                0\r\n            );\r\n        }\r\n    },\r\n    actions: {\r\n        async fetch(airplanesCount, flightsCount) {\r\n            this.airplanes = await service.fetch(airplanesCount, flightsCount);\r\n            this.alreadyFetched = true;\r\n\r\n            this.airplanes.forEach((airplane, airplaneIndex) => {\r\n                airplanesById.set(airplane.id, { airplaneIndex });\r\n\r\n                airplane.flights.forEach((flight, flightIndex) => {\r\n                    flightsById.set(flight.id, { airplaneIndex, flightIndex });\r\n                });\r\n            });\r\n        },\r\n        push(airplane) {\r\n            if (!airplanesById.get(airplane.id)) {\r\n                this.airplanes.push(airplane);\r\n                const airplaneIndex = this.airplanes.length - 1;\r\n                airplanesById.set(airplane.id, { airplaneIndex });\r\n\r\n                airplane.flights.forEach((flight, flightIndex) => {\r\n                    flightsById.set(flight.id, { airplaneIndex, flightIndex });\r\n                });\r\n            }\r\n        },\r\n        splice(...rest) {\r\n            const airplanes = this.airplanes.splice(rest);\r\n\r\n            airplanes.forEach((airplane) => {\r\n                airplanesById.delete(airplane.id);\r\n\r\n                airplane.flights.forEach((flight) => {\r\n                    flightsById.delete(flight.id);\r\n                });\r\n            });\r\n        }\r\n    }\r\n});\r\n","import { renderSlot as _renderSlot, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, vShow as _vShow, withDirectives as _withDirectives, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\";\nconst _withScopeId = n => (_pushScopeId(\"data-v-aeb90b02\"), n = n(), _popScopeId(), n);\nconst _hoisted_1 = {\n  class: \"wrapper-page\"\n};\nconst _hoisted_2 = {\n  key: 0,\n  class: \"main-header\"\n};\nconst _hoisted_3 = {\n  key: 1,\n  class: \"main\"\n};\nconst _hoisted_4 = {\n  key: 2,\n  class: \"main-footer\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  return _withDirectives((_openBlock(), _createElementBlock(\"div\", _hoisted_1, [_ctx.$slots.header ? (_openBlock(), _createElementBlock(\"header\", _hoisted_2, [_renderSlot(_ctx.$slots, \"header\", {}, undefined, true)])) : _createCommentVNode(\"\", true), _ctx.$slots.default ? (_openBlock(), _createElementBlock(\"main\", _hoisted_3, [_renderSlot(_ctx.$slots, \"default\", {}, undefined, true)])) : _createCommentVNode(\"\", true), _ctx.$slots.footer ? (_openBlock(), _createElementBlock(\"footer\", _hoisted_4, [_renderSlot(_ctx.$slots, \"footer\", {}, undefined, true)])) : _createCommentVNode(\"\", true)], 512)), [[_vShow, $props.show]]);\n}","export default {\n  props: {\n    show: {\n      type: Boolean,\n      default: true\n    }\n  }\n};","/* unplugin-vue-components disabled */import { render } from \"./page-default.vue?vue&type=template&id=aeb90b02&scoped=true\"\nimport script from \"./page-default.vue?vue&type=script&lang=js\"\nexport * from \"./page-default.vue?vue&type=script&lang=js\"\n\nimport \"./page-default.vue?vue&type=style&index=0&id=aeb90b02&lang=scss&scoped=true\"\n\nimport exportComponent from \"D:\\\\Projects\\\\code-example\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-aeb90b02\"]])\n\nexport default __exports__","import { toDisplayString as _toDisplayString, createElementVNode as _createElementVNode, resolveComponent as _resolveComponent, openBlock as _openBlock, createBlock as _createBlock, createCommentVNode as _createCommentVNode, createElementBlock as _createElementBlock, Fragment as _Fragment, withCtx as _withCtx, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\";\nconst _withScopeId = n => (_pushScopeId(\"data-v-709a6f04\"), n = n(), _popScopeId(), n);\nconst _hoisted_1 = {\n  class: \"fps\"\n};\nconst _hoisted_2 = {\n  key: 1,\n  class: \"no-airplane-message\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_highcharts = _resolveComponent(\"highcharts\");\n  const _component_app_layout_page_default = _resolveComponent(\"app-layout-page-default\");\n  return _openBlock(), _createBlock(_component_app_layout_page_default, null, {\n    default: _withCtx(() => [_createElementVNode(\"div\", _hoisted_1, \"FPS: \" + _toDisplayString($data.fps), 1), $data.store.alreadyFetched ? (_openBlock(), _createElementBlock(_Fragment, {\n      key: 0\n    }, [$data.store.airplanes.length ? (_openBlock(), _createBlock(_component_highcharts, {\n      key: 0,\n      class: \"chart\",\n      \"constructor-type\": 'ganttChart',\n      options: $data.chartOptions\n    }, null, 8, [\"options\"])) : (_openBlock(), _createElementBlock(\"span\", _hoisted_2, _toDisplayString($data.moduleConfig.mainLayer.noAirplanesMessage.text), 1))], 64)) : _createCommentVNode(\"\", true)]),\n    _: 1\n  });\n}","import \"core-js/modules/es.array.push.js\";\nimport { useFps } from \"@vueuse/core\";\nimport { useRoute } from \"vue-router\";\nimport moduleConfig from \"@/modules/airplane/config\";\nimport module from \"@/modules/airplane\";\nimport useStore from \"@/modules/airplane/store\";\nconst __default__ = {\n  data() {\n    return {\n      moduleConfig,\n      store: useStore(),\n      fps: useFps(),\n      chartOptions: {\n        chart: {\n          events: {\n            load() {\n              this.series.forEach(serie => {\n                serie.points.forEach(point => {\n                  this.renderer.text(dayjs(point.options.start).utc().format(\"HH:mm\"), point.plotX + this.plotLeft - 20, point.plotY + this.plotTop - 15).attr({\n                    rotation: 90,\n                    zIndex: 5\n                  }).css({\n                    fontSize: \"10px\",\n                    color: \"black\"\n                  }).add();\n                });\n              });\n            }\n          }\n        },\n        plotOptions: {\n          series: {\n            states: {\n              inactive: {\n                opacity: 1\n              }\n            }\n          }\n        },\n        series: [],\n        yAxis: {\n          categories: []\n        },\n        tooltip: {\n          outside: true\n        }\n      }\n    };\n  },\n  created() {\n    this.init();\n  },\n  methods: {\n    async init() {\n      const {\n        airplanesCount,\n        flightsCount\n      } = useRoute().query;\n      await module.fetch(airplanesCount, flightsCount);\n      this.setChartData();\n    },\n    setChartData() {\n      const series = [];\n      const categories = [];\n      module.store.airplanes.forEach((airplane, index) => {\n        series.push({\n          name: airplane.name,\n          data: _.map(airplane.flights, flight => ({\n            start: flight.departureDate.getTime(),\n            end: flight.arrivalDate.getTime(),\n            y: index,\n            id: flight.id\n          })),\n          // FIXME включены чисто для скорости разработки и тестирования\n          // перенести в chart.events.load:\n          //\n          // @see https://jsfiddle.net/highcharts/2A7Zf/\n          // @see https://jsfiddle.net/BlackLabel/ju9fy87g/\n          // 1) либо оставить как маркер;\n          //\n          // @see https://api.highcharts.com/class-reference/Highcharts.SVGRenderer#path\n          // 2) либо переписать на path\n          dataLabels: [{\n            enabled: true,\n            format: '<i class=\"fas fa-arrow-up\" style=\"font-size: 1.5em; margin-left: -20px\"></i>',\n            useHTML: true,\n            align: \"left\"\n          }, {\n            enabled: true,\n            format: '<i class=\"fas fa-save\" style=\"font-size: 1.5em\"></i>',\n            useHTML: true,\n            align: \"center\"\n          }, {\n            enabled: true,\n            format: `<div style=\"width: 20px; height: 20px; overflow: hidden; border-radius: 50%;\">\n                    <img src=\"https://github.com/bre1470.png\" style=\"width: 30px; margin-left: -5px; margin-top: -2px\">\n              </div>`,\n            useHTML: true,\n            align: \"right\"\n          }]\n        });\n        categories.push(airplane.name);\n      });\n      this.chartOptions.series = series;\n      this.chartOptions.yAxis.categories = categories;\n    }\n  }\n};\nimport { useCssVars as _useCssVars } from 'vue';\nconst __injectCSSVars__ = () => {\n  _useCssVars(_ctx => ({\n    \"348cc82c\": _ctx.moduleConfig.mainLayer.noAirplanesMessage.width,\n    \"72bc32df\": _ctx.moduleConfig.mainLayer.noAirplanesMessage.fill,\n    \"1c0a902c\": _ctx.moduleConfig.stageBackgroundColor\n  }));\n};\nconst __setup__ = __default__.setup;\n__default__.setup = __setup__ ? (props, ctx) => {\n  __injectCSSVars__();\n  return __setup__(props, ctx);\n} : __injectCSSVars__;\nexport default __default__;","/* unplugin-vue-components disabled */import { render } from \"./gantt.vue?vue&type=template&id=709a6f04&scoped=true\"\nimport script from \"./gantt.vue?vue&type=script&lang=js\"\nexport * from \"./gantt.vue?vue&type=script&lang=js\"\n\nimport \"./gantt.vue?vue&type=style&index=0&id=709a6f04&lang=scss&scoped=true\"\n\nimport exportComponent from \"D:\\\\Projects\\\\code-example\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-709a6f04\"]])\n\nexport default __exports__"],"names":["betweenItemsLineStroke","mainLayerRectRegularFill","scrollbarRegularFill","rowHeight","stageBackgroundColor","fixedLayerBorderStroke","timelinePrimaryColor","Color","darken","hex","fontDefaults","fontSize","fontFamily","wrap","ellipsis","mainLayer","flightRectTimeoutMs","rect","regularFill","activeFill","padding","strokeWidth","noAirplanesMessage","width","height","text","fill","fixedAside","textStartX","fixedHeader","stageScrollbarLayer","bar","minimumGreaterDimension","helper","opacity","airplaneNumber","y","datetime","x","timelineGrid","specialHour","regularHour","timelineLegend","startOfDay","underlineY","textStartY","dateFormat","startOfQuarterDay","flightSummary","departure","arrival","airplane","generateId","Math","random","toFixed","slice","number","prefixName","store","useStore","widthCorrectionPx","moduleConfig","heightCorrectionPx","totalHeight","this","airplanes","length","totalWidth","maxArrivalMs","dateToPx","Date","getTotalWidthCorrection","date","minDate","minDepartureMs","dayjs","diff","getCurrentXByIndex","index","add","startOf","toDate","getHourInPx","getCurrentDateByIndex","correction","isSpecialHour","hour","setTextDefaults","config","_","defaults","constructor","timeline","async","airplanesCount","flightsCount","data","fetch","window","backdoor","getFlightSummary","flightId","getAirplaneByFlightId","flight","getFlight","formatDate","format","name","departureDate","arrivalDate","Promise","resolve","generate","Number","parseInt","isNaN","range","map","id","initialDate","subtract","flights","flightsIndex","round","isSame","flightsById","Map","airplanesById","defineStore","state","alreadyFetched","getters","info","get","airplaneIndex","flightIndex","reduce","minInAirplanes","min","getTime","MAX_SAFE_INTEGER","maxInAirplanes","max","actions","service","forEach","set","push","splice","_len","arguments","rest","Array","_key","delete","_hoisted_1","class","_hoisted_2","key","_hoisted_3","_hoisted_4","props","show","type","Boolean","default","_ctx","_cache","$props","$setup","$data","$options","$slots","header","undefined","footer","__default__","fps","chartOptions","chart","events","load","series","serie","points","point","renderer","options","start","utc","plotX","plotLeft","plotY","plotTop","attr","rotation","zIndex","css","color","plotOptions","states","inactive","yAxis","categories","tooltip","outside","created","init","methods","query","setChartData","end","dataLabels","enabled","useHTML","align","__injectCSSVars__","__setup__","setup","ctx","_component_highcharts","_component_app_layout_page_default"],"sourceRoot":""}