{"version":3,"file":"js/489708f.chunk.js","mappings":"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","sources":["webpack://code-example/./src/pages/aircraft/flights/konva/native-scrollbars.vue?d792","webpack://code-example/./src/pages/aircraft/flights/konva/native-scrollbars.vue?dcd9","webpack://code-example/./src/pages/aircraft/flights/konva/native-scrollbars.vue?95e9"],"sourcesContent":["import { toDisplayString as _toDisplayString, createElementVNode as _createElementVNode, createTextVNode as _createTextVNode, resolveComponent as _resolveComponent, createVNode as _createVNode, withCtx as _withCtx, openBlock as _openBlock, createBlock as _createBlock, createCommentVNode as _createCommentVNode, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\";\nconst _withScopeId = n => (_pushScopeId(\"data-v-0cf5bca0\"), n = n(), _popScopeId(), n);\nconst _hoisted_1 = {\n  class: \"fps\"\n};\nconst _hoisted_2 = {\n  class: \"chart-title\"\n};\nconst _hoisted_3 = [\"href\"];\nconst _hoisted_4 = {\n  ref: \"scrollContainer\",\n  class: \"scroll-container\"\n};\nconst _hoisted_5 = {\n  class: \"large-container\"\n};\nconst _hoisted_6 = {\n  ref: \"stageContainer\",\n  class: \"stage-container\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_timeline_grid = _resolveComponent(\"timeline-grid\");\n  const _component_main_layer = _resolveComponent(\"main-layer\");\n  const _component_k_stage = _resolveComponent(\"k-stage\");\n  const _component_app_layout_page_default = _resolveComponent(\"app-layout-page-default\");\n  return _openBlock(), _createBlock(_component_app_layout_page_default, null, {\n    default: _withCtx(() => [_createElementVNode(\"div\", _hoisted_1, \"FPS: \" + _toDisplayString($data.fps), 1), _createElementVNode(\"h3\", _hoisted_2, [_createTextVNode(_toDisplayString($data.moduleConfig.chartTitle) + \" - \", 1), _createElementVNode(\"a\", {\n      href: _ctx.productionAbsoluteUrl + '/code-example/blob/master/src/docs/konva-research.md'\n    }, \"research\", 8, _hoisted_3)]), _createElementVNode(\"div\", _hoisted_4, [_createElementVNode(\"div\", _hoisted_5, [_createElementVNode(\"div\", _hoisted_6, [$data.configs.stage.height ? (_openBlock(), _createBlock(_component_k_stage, {\n      key: 0,\n      ref: \"stage\",\n      config: $data.configs.stage\n    }, {\n      default: _withCtx(() => [_createVNode(_component_main_layer, {\n        \"width-correction-px\": $data.widthCorrectionPx,\n        \"height-correction-px\": $data.heightCorrectionPx,\n        onFlightServicePointerdown: _cache[0] || (_cache[0] = $event => $data.toast.showInfo($data.module.getFlightSummary($event), {\n          timeout: $data.moduleConfig.mainLayer.flightRectTimeoutMs\n        })),\n        onFlightServicePointerenter: _cache[1] || (_cache[1] = $event => $data.stage.container().style.cursor = 'pointer'),\n        onFlightServicePointerleave: _cache[2] || (_cache[2] = $event => $data.stage.container().style.cursor = 'default')\n      }, {\n        \"timeline-grid\": _withCtx(() => [_createVNode(_component_timeline_grid)]),\n        _: 1\n      }, 8, [\"width-correction-px\", \"height-correction-px\"])]),\n      _: 1\n    }, 8, [\"config\"])) : _createCommentVNode(\"\", true)], 512)])], 512)]),\n    _: 1\n  });\n}","import \"core-js/modules/web.immediate.js\";\nimport { useFps } from \"@vueuse/core\";\nimport { useRoute } from \"vue-router\";\nimport toast from \"@/modules/toast\";\nimport module from \"@/modules/aircraft\";\nimport useStore from \"@/modules/aircraft/store\";\nimport moduleConfig from \"@/modules/aircraft/config\";\nimport TimelineGrid from \"@/modules/aircraft/views/timeline-grid\";\nimport MainLayer from \"@/modules/aircraft/views/layers/konva-main\";\nconst __default__ = {\n  components: {\n    MainLayer,\n    TimelineGrid\n  },\n  data() {\n    return {\n      moduleConfig,\n      module,\n      store: useStore(),\n      toast,\n      fps: useFps(),\n      stage: null,\n      configs: {\n        stage: {\n          width: 0,\n          height: 0,\n          padding: 200\n        }\n      },\n      widthCorrectionPx: 0,\n      heightCorrectionPx: 0\n    };\n  },\n  watch: {\n    \"store.aircrafts\": {\n      handler() {\n        this.actualizeStageDimensions();\n      },\n      deep: true\n    }\n  },\n  beforeUnmount() {\n    toast.clear();\n  },\n  created() {\n    this.init();\n  },\n  methods: {\n    async init() {\n      const {\n        aircraftsCount,\n        flightsCount\n      } = useRoute().query;\n      module.timeline.setWidthCorrectionPx(this.widthCorrectionPx);\n      module.timeline.setHeightCorrectionPx(this.heightCorrectionPx);\n      await module.fetch(aircraftsCount, flightsCount);\n      await this.initStage();\n      // this.testAnimationFrameDuration();\n    },\n\n    async initStage() {\n      window.addEventListener(\"resize\", _.throttle(this.actualizeStageDimensions, 100));\n      this.actualizeStageDimensions();\n      await this.$nextTick();\n      this.stage = this.$refs.stage.getStage();\n      this.stage.container().style.backgroundColor = this.moduleConfig.stageBackgroundColor;\n      const {\n        scrollContainer\n      } = this.$refs;\n      const repositionStage = () => {\n        const dx = scrollContainer.scrollLeft - this.getStagePaddingForAxis(\"x\");\n        const dy = scrollContainer.scrollTop - this.getStagePaddingForAxis(\"y\");\n        this.stage.container().style.transform = `translate(${dx}px, ${dy}px)`;\n        this.stage.x(-dx);\n        this.stage.y(-dy);\n      };\n      scrollContainer.addEventListener(\"scroll\", repositionStage, {\n        passive: true\n      });\n      repositionStage();\n    },\n    getStagePaddingForAxis(axis) {\n      if (!this.store.aircrafts.length) {\n        return 0;\n      }\n      let propName;\n      if (axis === \"x\") {\n        propName = \"width\";\n      } else if (axis === \"y\") {\n        propName = \"height\";\n      } else {\n        return 0;\n      }\n      propName = _.upperFirst(propName);\n      if (module.timeline[`total${propName}`]() > this.$refs.scrollContainer[`offset${propName}`] + this.configs.stage.padding * 2) {\n        return this.configs.stage.padding;\n      }\n      return 0;\n    },\n    actualizeStageDimensions() {\n      this.configs.stage.width = Math.min(module.timeline.totalWidth(), this.$refs.scrollContainer.offsetWidth + this.getStagePaddingForAxis(\"x\") * 2);\n      this.configs.stage.height = Math.min(module.timeline.totalHeight(), this.$refs.scrollContainer.offsetHeight + this.getStagePaddingForAxis(\"y\") * 2);\n      this.$refs.stageContainer.style.width = `${this.configs.stage.width}px`;\n      this.$refs.stageContainer.style.height = `${this.configs.stage.height}px`;\n      if (!this.stage) {\n        setImmediate(this.actualizeStageDimensions);\n        return;\n      }\n      this.$refs.scrollContainer.style.border = `${this.store.aircrafts.length ? \"1px solid black\" : \"none\"}`;\n    },\n    testAnimationFrameDuration() {\n      requestIdleCallback(() => {\n        this.$refs.scrollContainer.scrollLeft = 100;\n        requestAnimationFrame(() => {\n          const start = performance.now();\n          requestAnimationFrame(() => {\n            console.log(`'requestAnimationFrame' handler took ${Math.floor(performance.now() - start)}ms`);\n          });\n        });\n      });\n    }\n  }\n};\nimport { useCssVars as _useCssVars } from 'vue';\nconst __injectCSSVars__ = () => {\n  _useCssVars(_ctx => ({\n    \"0e9d81a2\": _ctx.moduleConfig.stageBackgroundColor,\n    \"46a056d6\": _ctx.module.timeline.totalWidth(),\n    \"a91bc68e\": _ctx.module.timeline.totalHeight(),\n    \"1424ea71\": _ctx.moduleConfig.mainLayer.noAircraftsMessage.width,\n    \"56a969dc\": _ctx.moduleConfig.mainLayer.noAircraftsMessage.height\n  }));\n};\nconst __setup__ = __default__.setup;\n__default__.setup = __setup__ ? (props, ctx) => {\n  __injectCSSVars__();\n  return __setup__(props, ctx);\n} : __injectCSSVars__;\nexport default __default__;","/* unplugin-vue-components disabled */import { render } from \"./native-scrollbars.vue?vue&type=template&id=0cf5bca0&scoped=true\"\nimport script from \"./native-scrollbars.vue?vue&type=script&lang=js\"\nexport * from \"./native-scrollbars.vue?vue&type=script&lang=js\"\n\nimport \"./native-scrollbars.vue?vue&type=style&index=0&id=0cf5bca0&lang=scss&scoped=true\"\n\nimport exportComponent from \"D:\\\\Projects\\\\code-example\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-0cf5bca0\"]])\n\nexport default __exports__"],"names":["_hoisted_1","class","_hoisted_2","_hoisted_3","_hoisted_4","ref","_hoisted_5","_hoisted_6","__default__","components","MainLayer","TimelineGrid","data","moduleConfig","module","store","toast","fps","stage","configs","width","height","padding","widthCorrectionPx","heightCorrectionPx","watch","handler","this","actualizeStageDimensions","deep","beforeUnmount","created","init","methods","async","aircraftsCount","flightsCount","query","initStage","window","addEventListener","_","throttle","$nextTick","$refs","getStage","container","style","backgroundColor","stageBackgroundColor","scrollContainer","repositionStage","dx","scrollLeft","getStagePaddingForAxis","dy","scrollTop","transform","x","y","passive","axis","aircrafts","length","propName","upperFirst","Math","min","offsetWidth","offsetHeight","stageContainer","border","setImmediate","testAnimationFrameDuration","requestIdleCallback","requestAnimationFrame","start","performance","now","console","log","floor","__injectCSSVars__","_ctx","timeline","totalWidth","totalHeight","mainLayer","noAircraftsMessage","__setup__","setup","props","ctx","_cache","$props","$setup","$data","$options","_component_timeline_grid","_component_main_layer","_component_k_stage","_component_app_layout_page_default","default","chartTitle","href","productionAbsoluteUrl","key","config","onFlightServicePointerdown","$event","showInfo","getFlightSummary","timeout","flightRectTimeoutMs","onFlightServicePointerenter","cursor","onFlightServicePointerleave"],"sourceRoot":""}